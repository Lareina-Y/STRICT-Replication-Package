Write archive record archive param record record data write archive write Record writeRecord record IOException debug System err println Write Record WriteRecord rec Idx recIdx curr Rec Idx currRecIdx blk Idx blkIdx curr Blk Idx currBlkIdx out Stream outStream IOException writing input buffer record length record Size recordSize IOException record write length record length record size record Size recordSize curr Rec Idx currRecIdx recs Per Block recsPerBlock write Block writeBlock System arraycopy record block Buffer blockBuffer curr Rec Idx currRecIdx record Size recordSize record Size recordSize curr Rec Idx currRecIdx