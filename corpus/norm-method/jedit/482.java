Write archive record archive record larger array buffer buffer offset record size param buf buffer record data write param offset offset record data buf write Record writeRecord buf offset IOException debug System err println Write Record WriteRecord rec Idx recIdx curr Rec Idx currRecIdx blk Idx blkIdx curr Blk Idx currBlkIdx out Stream outStream IOException writing input buffer offset record Size recordSize buf length IOException record length buf length offset offset record size record Size recordSize curr Rec Idx currRecIdx recs Per Block recsPerBlock write Block writeBlock System arraycopy buf offset block Buffer blockBuffer curr Rec Idx currRecIdx record Size recordSize record Size recordSize curr Rec Idx currRecIdx