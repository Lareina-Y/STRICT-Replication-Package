redo method Override Selection redo Undo Manager UndoManager mgr mgr buffer remove offset str length mgr redo Clear Dirty redoClearDirty mgr buffer set Dirty setDirty Selection Selection Range offset offset