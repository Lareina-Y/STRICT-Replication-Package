Utility methods instruction resizing handle JSR Resizes designated instructions keeping jump offsets instruction addresses consistent require resize existing instructions introduce instructions increasing size instruction middle method increases offset IFEQ instruction IFEQ replaced IFNEQ turn require increase size jump instruction operations handled automatically method method called method built visited link Label Label objects construct method longer valid method called param indexes current positions instructions resized instruction designated instruction param sizes number bytes instructions precisely len sizes bytes instruction designated indexes sizes negative sizes bytes instruction removed instruction size negative gaps introduced method filled manually array returned link get Code getCode get Code getCode method param len number instruction resized smaller equal indexes length sizes length indexes array positions resized instructions designated resize Instructions resizeInstructions indexes sizes len bytecode method code data indexes label loop indexes step explained resizing instruction require resize require resize step algorithm consists finding instructions resized modifying code point algorithm parse code find jump instructions offset bytes stored offset computed current offset number bytes inserted removed source target instructions instruction adds entry copy indexes sizes arrays previous iteration entry previous step fact real algorithm complicated fact size TABLESWITCH LOOKUPSWITCH instructions depends position bytecode padding order ensure convergence algorithm number bytes removed instructions estimated previous loop computed loop finished requires pass parse bytecode method copy indexes all Indexes allIndexes len copy sizes all Sizes allSizes len instructions resized resize offset jump instruction new Offset newOffset System arraycopy indexes all Indexes allIndexes len System arraycopy sizes all Sizes allSizes len resize code length loop loop ended pass length opcode current instruction opcode x FF xFF bytes instruction insert Class Writer ClassWriter TYPE opcode Class Writer ClassWriter NOARG INSN Class Writer ClassWriter IMPLVAR INSN Class Writer ClassWriter LABEL INSN opcode converts temporary opcodes inclusive IFEQ JSR inclusive IFNULL IFNONNULL opcode opcode opcode opcode label read Unsigned Short readUnsignedShort label read Short readShort new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Offset newOffset MIN new Offset newOffset MAX resize opcode Constants opcode Constants JSR additional bytes required replace JSR instruction JSR insert additional bytes required replace IFxxx instruction IFNOTxxx IFNOTxxx opcode IFxxx IFNE IFEQ designates instruction insert resize Class Writer ClassWriter LABELW INSN Class Writer ClassWriter TABL INSN number bytes removed instruction number padding bytes current number padding estimated variation new Offset newOffset new Offset newOffset new Offset newOffset new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes insert new Offset newOffset resize estimation number bytes instruction current number padding bytes insert resize skips instruction read Int readInt read Int readInt Class Writer ClassWriter INSN TABL INSN new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes insert new Offset newOffset resize TABL INSN insert resize skips instruction read Int readInt Class Writer ClassWriter WIDE INSN opcode x FF xFF opcode Constants IINC Class Writer ClassWriter INSN Class Writer ClassWriter SBYTE INSN Class Writer ClassWriter LDC INSN Class Writer ClassWriter INSN Class Writer ClassWriter LDCW INSN Class Writer ClassWriter FIELDORMETH INSN Class Writer ClassWriter TYPE INSN Class Writer ClassWriter IINC INSN Class Writer ClassWriter ITFMETH INSN Class Writer ClassWriter MANA INSN insert adds insert entry all Indexes allIndexes all Sizes allSizes arrays new Indexes newIndexes all Indexes allIndexes length new Sizes newSizes all Sizes allSizes length System arraycopy all Indexes allIndexes new Indexes newIndexes all Indexes allIndexes length System arraycopy all Sizes allSizes new Sizes newSizes all Sizes allSizes length new Indexes newIndexes all Indexes allIndexes length new Sizes newSizes all Sizes allSizes length insert all Indexes allIndexes new Indexes newIndexes all Sizes allSizes new Sizes newSizes insert step copies bytecode method bytevector updates offsets inserts removes bytes requested Byte Vector ByteVector new Code newCode Byte Vector ByteVector code length code length all Indexes allIndexes length all Indexes allIndexes len sizes new Code newCode put Byte Array putByteArray sizes new Code newCode length sizes indexes new Code newCode length opcode x FF xFF Class Writer ClassWriter TYPE opcode Class Writer ClassWriter NOARG INSN Class Writer ClassWriter IMPLVAR INSN new Code newCode opcode Class Writer ClassWriter LABEL INSN opcode temporary opcodes inclusive IFEQ JSR inclusive IFNULL IFNONNULL opcode opcode opcode opcode label read Unsigned Short readUnsignedShort label read Short readShort new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Offset newOffset MIN new Offset newOffset MAX instruction opcode Constants new Code newCode opcode Constants JSR JSR new Code newCode new Code newCode opcode opcode opcode jump offset new Code newCode new Code newCode new Offset newOffset computed start new Offset newOffset new Code newCode new Offset newOffset new Code newCode opcode new Code newCode new Offset newOffset Class Writer ClassWriter LABELW INSN label read Int readInt new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Code newCode opcode new Code newCode new Offset newOffset Class Writer ClassWriter TABL INSN skips padding bytes reads copies instruction source new Code newCode length new Code newCode Constants TABLESWITCH new Code newCode length new Code newCode label read Int readInt new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Code newCode new Offset newOffset read Int readInt new Code newCode read Int readInt new Code newCode read Int readInt label read Int readInt new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Code newCode new Offset newOffset Class Writer ClassWriter INSN skips padding bytes reads copies instruction source new Code newCode length new Code newCode Constants LOOKUPSWITCH new Code newCode length new Code newCode label read Int readInt new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Code newCode new Offset newOffset read Int readInt new Code newCode new Code newCode read Int readInt label read Int readInt new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Code newCode new Offset newOffset Class Writer ClassWriter WIDE INSN opcode x FF xFF opcode Constants IINC new Code newCode put Byte Array putByteArray new Code newCode put Byte Array putByteArray Class Writer ClassWriter INSN Class Writer ClassWriter SBYTE INSN Class Writer ClassWriter LDC INSN new Code newCode put Byte Array putByteArray Class Writer ClassWriter INSN Class Writer ClassWriter LDCW INSN Class Writer ClassWriter FIELDORMETH INSN Class Writer ClassWriter TYPE INSN Class Writer ClassWriter IINC INSN new Code newCode put Byte Array putByteArray Class Writer ClassWriter ITFMETH INSN new Code newCode put Byte Array putByteArray MANA INSN new Code newCode put Byte Array putByteArray local number tables catch Table catchTable catch Table catchTable data catch Table catchTable length write Short writeShort get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes read Unsigned Short readUnsignedShort write Short writeShort get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes read Unsigned Short readUnsignedShort write Short writeShort get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes read Unsigned Short readUnsignedShort local Var localVar local Var localVar data local Var localVar length label read Unsigned Short readUnsignedShort new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label write Short writeShort new Offset newOffset label read Unsigned Short readUnsignedShort new Offset newOffset get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes label new Offset newOffset write Short writeShort new Offset newOffset line Number lineNumber line Number lineNumber data line Number lineNumber length write Short writeShort get New Offset getNewOffset all Indexes allIndexes all Sizes allSizes read Unsigned Short readUnsignedShort replaces bytecodes code new Code newCode returns positions resized instructions indexes