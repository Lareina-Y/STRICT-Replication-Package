file bean shell beanshell java scripting distribution documentation updates http beanshell org sun license notice contents file subject sun license version license file compliance license copy license http sun original code bean shell beanshell initial developer original code pat niemeyer portions created pat niemeyer copyright rights reserved gnu license notice alternatively contents file terms gnu lesser general license lgpl provisions lgpl applicable version file terms lgpl version file spl decision deleting provisions replace notice provisions required lgpl delete provisions recipient version file spl lgpl patrick niemeyer pat pat net author learning java reilly associates http pat net pat org gjt jedit bsh java net java util java java lang reflect method java lang reflect modifier implementation notes note synchronization note version dependency base jdk compatible forced weak references full featured implementation optional bsh classpath accomodate fleeting namespace listeners fall scope name spaces namespaces informed space cache names simpler idea entities reference cached types perform light weight check counter reference detect namespace puts burden consumer check times eliminate listener system places necessity weak references suppress warnings suppresswarnings unchecked bsh class manager bshclassmanager identifier item hashtable set object novalue object interpreter created manager load scripted classes source files interpreter declaring interpreter declaringinterpreter external classloader supplied set class loader setclassloader command class loader classloader external class loader externalclassloader global cache classes note implemented soft references opposed strong weak hashtable absolute class cache absoluteclasscache hashtable global cache classes note implemented soft references opposed strong weak hashtable absolute non classes absolutenonclasses hashtable caches resolved object methods maps separate support fast lookup general method hashtable resolved object methods resolvedobjectmethods hashtable hashtable resolved static methods resolvedstaticmethods hashtable hashtable defining classes definingclasses hashtable hashtable defining classes base names definingclassesbasenames hashtable create instance manager manager instnaces interpreter org gjt jedit bsh interpreter get class manager getclassmanager get class manager getclassmanager org gjt jedit bsh interpreter set class loader setclassloader class loader classloader set class loader setclassloader bsh class manager bshclassmanager create class manager createclassmanager interpreter interpreter bsh class manager bshclassmanager manager jdk packages optional capabilities class exists classexists java lang weak reference weakreference capabilities class exists classexists java util hash map hashmap capabilities class exists classexists org gjt jedit bsh classpath class manager impl classmanagerimpl load module don refer dependent clas for name forname org gjt jedit bsh classpath class manager impl classmanagerimpl manager bsh class manager bshclassmanager clas get declared constructor getdeclaredconstructor new instance newinstance exception interpreter error interpretererror error loading classmanager manager bsh class manager bshclassmanager interpreter interpreter interpreter manager declaring interpreter declaringinterpreter interpreter manager class exists classexists string class for name classforname load account classpath reloaded classes note trivial implementation bsh classpath class manager impl classmanagerimpl fully functional management class for name classforname string is class being defined isclassbeingdefined interpreter error interpretererror attempting load process defined clas clas plain class for name plainclassforname class not found exception classnotfoundexception scripted clas clas load source class loadsourceclass clas move classpath class manager impl classmanagerimpl load source class loadsourceclass string string file name filename replace java input stream inputstream get resource as stream getresourceasstream file name filename system println loading source file file name filename declaring interpreter declaringinterpreter eval input stream reader inputstreamreader eval error evalerror system err println plain class for name plainclassforname class not found exception classnotfoundexception system err println source file perform plain for name forname call externally classloader bsh class manager bshclassmanager implementation loaded call delegated additional hooks simply wraps bottom level lookup call central point monitoring handling java version dependent bugs class for name classforname string plain class for name plainclassforname string class not found exception classnotfoundexception external class loader externalclassloader external class loader externalclassloader load class loadclass for name forname cache class info cacheclassinfo original note jdk win throwing warn upper mismatch bsh console bsh console update prior squeltching no class def found errors noclassdeffounderrors annoying reproduce original problem valid solution legacy vms problems include specific test no class def found error noclassdeffounderror no class def found noclassdeffound resource url bean shell beanshell classpath param path absolute path url get resource getresource string path url url external class loader externalclassloader classloader leading slash url external class loader externalclassloader get resource getresource path substring url url interpreter get resource getresource path url resource stream bean shell beanshell classpath param path absolute path input stream inputstream get resource as stream getresourceasstream string path input stream inputstream external class loader externalclassloader classloader leading slash external class loader externalclassloader get resource as stream getresourceasstream path substring interpreter get resource as stream getresourceasstream path cache info param cache set flag speed resolution cache class info cacheclassinfo string absolute class cache absoluteclasscache absolute non classes absolutenonclasses novalue cache resolved overloaded method based argument types invoke subject classloader change object methods cached separately support fast lookup general cache resolved method cacheresolvedmethod clas types method method interpreter debug interpreter debug cache resolved method cacheresolvedmethod putting clas method signature key signaturekey signature key signaturekey clas method get name getname types modifier is static isstatic method get modifiers getmodifiers resolved static methods resolvedstaticmethods method resolved object methods resolvedobjectmethods method cached resolved method param only static onlystatic specifies method returned method method get resolved method getresolvedmethod clas string method name methodname types only static onlystatic signature key signaturekey signature key signaturekey clas method name methodname types object allowed note java compiler method method method resolved static methods resolvedstaticmethods method only static onlystatic method method resolved object methods resolvedobjectmethods interpreter debug method interpreter debug get resolved method getresolvedmethod cache clas method name methodname interpreter debug get resolved method getresolvedmethod cache hit clas method method clear caches bsh class manager bshclassmanager clear caches clearcaches absolute non classes absolutenonclasses hashtable absolute class cache absoluteclasscache hashtable resolved object methods resolvedobjectmethods hashtable resolved static methods resolvedstaticmethods hashtable set external loader bean shell beanshell point plain for name forname explicit classpath management script add class path addclasspath set class path setclasspath reload classes reloadclasses bean shell beanshell supplied classloader additional classpath management bean shell beanshell perform addition supplied external classloader bean shell beanshell reload classes supplied external classloader set class loader setclassloader class loader classloader external cl externalcl external class loader externalclassloader external cl externalcl class loader changed classloaderchanged add class path addclasspath url path ioexception clear loaders start loading reset clear caches clearcaches set base classpath create base classloader types change set class path setclasspath url util eval error utilevalerror cm unavailable cmunavailable overlay entire path loader set base path user path base path point including boot path reload thos reload all classes reloadallclasses util eval error utilevalerror cm unavailable cmunavailable reloading classes creating classloader asked classes space discrete files class loader discretefilesclassloader reload classes reloadclasses string class names classnames util eval error utilevalerror cm unavailable cmunavailable reload classes sun tools special unpackaged refer unpackaged classes reload package reloadpackage string pack util eval error utilevalerror cm unavailable cmunavailable removed shield core classpath classpath classmanager impl bsh class path bshclasspath get class path getclasspath class path exception classpathexception support hide details opposed name space namespace do super import dosuperimport util eval error utilevalerror cm unavailable cmunavailable operation performed has super import hassuperimport class path exception classpathexception detail ambigous string get class name by unq name getclassnamebyunqname string util eval error utilevalerror cm unavailable cmunavailable add listener addlistener listener remove listener removelistener listener dump print writer printwriter println bsh class manager bshclassmanager manager flag process defined manager attempt load note implementation temporary flat namespace base classes bean shell beanshell process defining classes packages base remove limitation requires work namespace imports analogous path regular resolution workaround handle cases defining class definingclass string class name classname string base name basename suffix class name classname base name basename index of indexof base name basename base name basename substring string cur string defining classes base names definingclassesbasenames base name basename cur interpreter error interpretererror defining problem class name classname bean shell beanshell simultaneously define dependant classes attempt define class name classname defining cur defining classes definingclasses class name classname novalue defining classes base names definingclassesbasenames base name basename class name classname is class being defined isclassbeingdefined string class name classname defining classes definingclasses class name classname method temporary workaround defining class definingclass removed point string get class being defined getclassbeingdefined string class name classname string base name basename suffix class name classname string defining classes base names definingclassesbasenames base name basename defined loaded done defining class donedefiningclass string class name classname string base name basename suffix class name classname defining classes definingclasses remove class name classname defining classes base names definingclassesbasenames remove base name basename real implementation classpath class manager impl classmanagerimpl handles reloading generated classes define class defineclass string code interpreter error interpretererror create manager implementation injected classes parent classloader incorrect behavior reasons biggest problem classes defined executions script class loader classloader get class getclass get class loader getclassloader clas clas reflect invoke object method invokeobjectmethod define class defineclass object code primitive offset primitive code length len interpreter call stack callstack simple node simplenode exception print stack trace printstacktrace interpreter error interpretererror unable define absolute non classes absolutenonclasses remove axed clas class loader changed classloaderchanged annotate no class def found error noclassdeffounderror info load error no class def found noclassdeffound string class name classname error no class def found error noclassdeffounderror required class name classname loaded to string tostring util eval error utilevalerror cm unavailable cmunavailable capabilities unavailable class loading classloading features unavailable listener class loader changed classloaderchanged note signature key signaturekey dangerous pathological user eat memory caching combination argument types untyped method smarter ignoring types untyped parameter positions method resolver set hints signature key caching overhead creating method dispatched alternative signature key signaturekey clas types string method name methodname hash code hashcode signature key signaturekey clas string method name methodname types clas clas method name methodname method name methodname types types hash code hashcode hash code hashcode hash code hashcode clas hash code hashcode method name methodname hash code hashcode args method types hash code hashcode types length types types hash code hashcode hash code hashcode hash code hashcode hash code hashcode equals object signature key signaturekey target signature key signaturekey types target types clas target clas method name methodname equals target method name methodname types length target types length types length types target types types equals target types