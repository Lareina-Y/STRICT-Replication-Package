file bean shell beanshell java scripting distribution documentation updates http beanshell org sun license notice contents file subject sun license version license file compliance license copy license http sun original code bean shell beanshell initial developer original code pat niemeyer portions created pat niemeyer copyright rights reserved gnu license notice alternatively contents file terms gnu lesser general license lgpl provisions lgpl applicable version file terms lgpl version file spl decision deleting provisions replace notice provisions required lgpl delete provisions recipient version file spl lgpl patrick niemeyer pat pat net author learning java reilly associates http pat net pat org gjt jedit bsh java util java input stream inputstream java input stream reader inputstreamreader java ioexception java lang reflect method java lang reflect field slava pestov j edit jedit fame caching enhancements note big broken bit suppress warnings suppresswarnings unchecked name space namespace java serializable bsh class manager bshclassmanager listener name source namesource name space namespace javacode name space namespace bsh class manager bshclassmanager called compiled java code javacode is method ismethod instance data note add reset clear method namespace namespace method body namespace method instance string ns name nsname name space namespace parent hashtable variables hashtable methods hashtable imported classes importedclasses vector imported packages importedpackages vector imported commands importedcommands vector imported objects importedobjects vector imported static importedstatic string package name packagename bsh class manager bshclassmanager class manager classmanager notes get this getthis this reference thisreference resolver objects hashtable names node creation namespace support get invocation line getinvocationline get invocation text getinvocationtext simple node simplenode caller info node callerinfonode note namespace method body namespace printing stack traces exceptions is method ismethod note namespace body instance namespace controlling object precedence note move behavior subclass name space namespace start is class isclass class static classstatic object class instance classinstance set class static setclassstatic clas class static classstatic clas import static importstatic clas set class instance setclassinstance object instance class instance classinstance instance import object importobject instance object get class instance getclassinstance util eval error utilevalerror class instance classinstance class instance classinstance class static classstatic util eval error utilevalerror refer instance context interpreter error interpretererror resolve instance local cache classes resolved namespace get class getclass account imports unqualified names cached imported qualified names absolute cached bsh class manager bshclassmanager hashtable class cache classcache param parent parent namespace namespace child namespaces inherit variables methods parent override shadow param name space namespace name space namespace parent string note parent manager parent name space namespace bsh class manager bshclassmanager class manager classmanager string class manager classmanager name space namespace name space namespace parent bsh class manager bshclassmanager class manager classmanager string explicitly interpreter global prune class manager classmanager parent create manager set name setname set parent setparent parent set class manager setclassmanager class manager classmanager register notification classloader change class manager classmanager class manager classmanager add listener addlistener constructors set name setname string ns name nsname namespace namespace method body namespace method instance string get name getname ns name nsname set node creation namespace debugging support get invocation line getinvocationline get invocation text getinvocationtext methods set node setnode simple node simplenode node caller info node callerinfonode node simple node simplenode get node getnode caller info node callerinfonode caller info node callerinfonode parent parent get node getnode resolve object namespace object string interpreter interpreter util eval error utilevalerror call stack callstack callstack call stack callstack get name resolver getnameresolver to object toobject callstack interpreter set variable namespace method obeys localscoping property determine variables set note method intended internally method bsh set variables primitive values wrap bsh primitive org gjt jedit bsh primitive setting variable didn exist removing variable namespace change param strict java strictjava specifies strict java rules applied set variable setvariable string object strict java strictjava util eval error utilevalerror localscoping follow strict java strictjava recurse recurse interpreter localscoping strict java strictjava set variable setvariable strict java strictjava recurse set variable explicitly local scope set local variable setlocalvariable string object strict java strictjava util eval error utilevalerror set variable setvariable strict java strictjava set variable namespace variable existing existing variable live namespace parent namespace recurse note method localscoping caller methods set recurse intelligently situations based localscoping note method intended internally method bsh set variables primitive values wrap bsh primitive org gjt jedit bsh primitive setting variable didn exist removing variable namespace change param strict java strictjava specifies strict java rules applied param recurse determines search variable parent scope assigning locally set variable setvariable string object strict java strictjava recurse util eval error utilevalerror variables variables hashtable don j edit jedit core plugins unset variable unsetvariable locate variable definition exists variable existing get variable impl getvariableimpl recurse existing variable recurse allowed existing existing set value setvalue variable assignment util eval error utilevalerror util eval error utilevalerror variable assignment get message getmessage previous variable definition recurse strict java strictjava util eval error utilevalerror strict java mode assignment undeclared variable recurse set global untyped set name space namespace var scope varscope recurse get global getglobal modification allocation local name space namespace var scope varscope var scope varscope variables variable name space changed namespacechanged variable addition name space changed namespacechanged remove variable namespace unset variable unsetvariable string variables variables remove name space changed namespacechanged names variables defined namespace variables parent namespaces string get variable names getvariablenames variables string enumeration to string array enumerationtostringarray variables names methods declared namespace include methods parent namespaces string get method names getmethodnames methods string enumeration to string array enumerationtostringarray methods methods defined namespace methods parent namespaces note renamed get declared methods getdeclaredmethods bsh method bshmethod get methods getmethods methods bsh method bshmethod flatten method collection flattenmethodcollection methods elements string enumeration to string array enumerationtostringarray enumeration vector vector has more elements hasmoreelements add element addelement next element nextelement string string size copy into copyinto flatten vectors overloaded methods single array get methods getmethods bsh method bshmethod flatten method collection flattenmethodcollection enumeration vector vector has more elements hasmoreelements object next element nextelement bsh method bshmethod add element addelement vector vector size add element addelement element at elementat bsh method bshmethod bma bsh method bshmethod size copy into copyinto bma bma parent namespace note isn get super getsuper get super getsuper returns root namespace name space namespace get parent getparent parent parent namespace reference namespace reference top get super getsuper interpreter declaring interpreter declaringinterpreter parent parent get this getthis declaring interpreter declaringinterpreter get this getthis declaring interpreter declaringinterpreter top level namespace namespace top note method type bsh consistent get this getthis get global getglobal interpreter declaring interpreter declaringinterpreter parent parent get global getglobal declaring interpreter declaringinterpreter get this getthis declaring interpreter declaringinterpreter object thin layer namespace comprising bsh object context handles types bsh object supports aspects method invocation declaring interpreter declaringinterpreter support callbacks java generated proxies scripted object remembers created printing messages interpreter phenomenon called externally java note singleton work good idea speed caching single instance technically incorrect declaring interpreter declaringinterpreter circumstances child interpreter running source eval command main interpreter executes script involved call backs java corner cases child interpreter reference namespace problems experiments find cache interpreter basis weak references skipping child interpreters parent declaring interpreter top interpreter get this getthis interpreter declaring interpreter declaringinterpreter this reference thisreference this reference thisreference get this getthis declaring interpreter declaringinterpreter this reference thisreference bsh class manager bshclassmanager get class manager getclassmanager class manager classmanager class manager classmanager parent parent javacode parent get class manager getclassmanager system println experiment creating manager class manager classmanager bsh class manager bshclassmanager create class manager createclassmanager interpreter debug manager namespace class manager classmanager set class manager setclassmanager bsh class manager bshclassmanager class manager classmanager class manager classmanager class manager classmanager serialization prune class manager classmanager xxx create class manager createclassmanager get class manager getclassmanager axe set class manager setclassmanager bsh class manager bshclassmanager create class manager createclassmanager set parent setparent set parent setparent name space namespace parent parent parent disconnected root handle def imports parent load default imports loaddefaultimports variable namespace parent namespace note method intended internally method bsh primitive unwrap primitive values primitive unwrap object variable primitive defined object get variable getvariable string util eval error utilevalerror get variable getvariable variable namespace param recurse recurse recursively search parent namespaces variable note method intended internally method bsh primitive unwrap primitive values primitive unwrap object variable primitive defined object get variable getvariable string recurse util eval error utilevalerror variable get variable impl getvariableimpl recurse unwrap variable unwrapvariable locate variable variable object optional recursion parent spaces namespace variables variable defined variable get variable impl getvariableimpl string recurse util eval error utilevalerror variable imported is class isclass get imported var getimportedvar variables variable variables change precedence body instance is class isclass get imported var getimportedvar parent recurse parent parent get variable impl getvariableimpl recurse variables declared namespace variable get declared variables getdeclaredvariables variables variable variable vars variable variables size enumeration variables elements has more elements hasmoreelements vars variable next element nextelement vars unwrap variable variable mapped primitive object unwrap variable unwrapvariable variable util eval error utilevalerror primitive get value getvalue deprecated set typed variable settypedvariable string object modifiers set typed variable settypedvariable string type object is final isfinal util eval error utilevalerror modifiers modifiers modifiers is final isfinal modifiers add modifier addmodifier modifiers field set typed variable settypedvariable type modifiers declare variable local scope set initial variable type integer types object types existing typed variable set type untyped variable exists overridden typed set perform types get assignable form getassignableform note method intended internally method bsh set variables primitive values wrap bsh primitive org gjt jedit bsh primitive param type param modifiers set typed variable settypedvariable string type object modifiers modifiers util eval error utilevalerror variables variables hashtable setting typed variable local operation variable existing get variable impl getvariableimpl variable exist existing typed existing get type gettype assignable type existing get type gettype type util eval error utilevalerror typed variable declared type existing get type gettype set existing set value setvalue variable declaration careful fall override install typed version add typed variables variable type modifiers dissallow vars param error message check variable modifiers checkvariablemodifiers string modifiers modifiers util eval error utilevalerror modifiers modifiers has modifier hasmodifier util eval error utilevalerror declare variable note internal interpreter source string interpreter eval string set method setmethod string bsh method bshmethod method util eval error utilevalerror methods methods hashtable object methods j edit jedit version properly handle methods signature methods method bsh method bshmethod method overriding method arrays equals bsh method bshmethod get parameter types getparametertypes method get parameter types getparametertypes methods method vector vector add element addelement add element addelement method methods vector methods vector methods size check method overrides method list bsh method bshmethod bsh method bshmethod methods arrays equals get parameter types getparametertypes method get parameter types getparametertypes methods remove methods add element addelement method original bean shell beanshell code methods method bsh method bshmethod vector vector add element addelement add element addelement method methods vector vector add element addelement method get method getmethod string get method getmethod string bsh method bshmethod get method getmethod string sig util eval error utilevalerror get method getmethod sig bsh method matching signature declared space parent note method intended internally method bsh familiar bean shell beanshell primitive wrapper org gjt jedit bsh primitive bsh method bshmethod param declared only declaredonly methods declared namespace inherited imported methods visible bsh method bshmethod get method getmethod string sig declared only declaredonly util eval error utilevalerror bsh method bshmethod method method is class isclass declared only declaredonly method get imported method getimportedmethod sig object method methods methods bsh method bshmethod vector bsh method bshmethod unwrap bsh method bshmethod vector vector vector bsh method bshmethod size copy into copyinto bsh method bshmethod bsh method bshmethod apply specific signature matching candidates length length candidates get parameter types getparametertypes match reflect find most specific signature findmostspecificsignature sig candidates match method match method is class isclass declared only declaredonly method get imported method getimportedmethod sig parent declared only declaredonly method parent parent get method getmethod sig method subsequent imports override earlier import class importclass string imported classes importedclasses imported classes importedclasses hashtable imported classes importedclasses suffix name space changed namespacechanged subsequent imports override earlier import package importpackage string imported packages importedpackages imported packages importedpackages vector exists remove add avoid memory leak imported packages importedpackages imported packages importedpackages remove imported packages importedpackages add element addelement name space changed namespacechanged scripted compiled bean shell beanshell commands classpath path notation import commands importcommands bsh commands import commands importcommands bsh commands equivalent relative path style specifier absolute path prepending import commands importcommands string imported commands importedcommands imported commands importedcommands vector dots slashes replace absolute starts with startswith remove trailing preserve simple length ends with endswith substring length exists remove add avoid memory leak imported commands importedcommands imported commands importedcommands remove imported commands importedcommands add element addelement name space changed namespacechanged command scripted method compiled command implementing method signature commands loaded classpath imported import commands importcommands method method searches imported commands packages script command object method script script sourced namespace bsh method bshmethod requested signature returned compiled returned compiled command classes implement invoke methods imported packages searched reverse order imports priority object script checked overloaded form located fixed bsh method bshmethod command param desired command method param arg types argtypes signature desired command method util eval error utilevalerror load scripted command loadscriptedcommand util eval error utilevalerror errors loading script j edit jedit get command getcommand object get command getcommand string arg types argtypes interpreter interpreter util eval error utilevalerror interpreter debug interpreter debug get command getcommand bsh class manager bshclassmanager bcm interpreter get class manager getclassmanager input stream inputstream get command getcommand load scripted command loadscriptedcommand arg types argtypes interpreter parent parent get command getcommand arg types argtypes interpreter object get command getcommand string arg types argtypes interpreter interpreter util eval error utilevalerror interpreter debug interpreter debug get command getcommand bsh class manager bshclassmanager bcm interpreter get class manager getclassmanager imported commands importedcommands loop precedence imported commands importedcommands size string path string imported commands importedcommands element at elementat string script path scriptpath path equals script path scriptpath path bsh script path scriptpath path bsh interpreter debug searching script script path scriptpath input stream inputstream bcm get resource as stream getresourceasstream script path scriptpath load scripted command loadscriptedcommand arg types argtypes script path scriptpath interpreter chop leading change string class name classname path equals class name classname class name classname path substring replace interpreter debug searching class name classname clas bcm class for name classforname class name classname clas clas parent parent get command getcommand arg types argtypes interpreter bsh method bshmethod get imported method getimportedmethod string sig util eval error utilevalerror object imports imported objects importedobjects imported objects importedobjects size object object imported objects importedobjects element at elementat clas object get class getclass method method reflect resolve java method resolvejavamethod get class manager getclassmanager clas sig method bsh method bshmethod method object imports imported static importedstatic imported static importedstatic size clas imported static importedstatic element at elementat method method reflect resolve java method resolvejavamethod get class manager getclassmanager clas sig method bsh method bshmethod method variable get imported var getimportedvar string util eval error utilevalerror object imports imported objects importedobjects imported objects importedobjects size object object imported objects importedobjects element at elementat clas object get class getclass field field reflect resolve java field resolvejavafield clas field variable field get type gettype lhs object field imports imported static importedstatic imported static importedstatic size clas imported static importedstatic element at elementat field field reflect resolve java field resolvejavafield clas field variable field get type gettype lhs field load command script input stream find bsh method bshmethod target namespace util eval error utilevalerror error parsing script method parsing script support multiple commands command path change exception bsh method bshmethod load scripted command loadscriptedcommand input stream inputstream string arg types argtypes string resource path resourcepath interpreter interpreter util eval error utilevalerror interpreter eval input stream reader inputstreamreader resource path resourcepath eval error evalerror interpreter debug to string tostring util eval error utilevalerror error loading script get message getmessage loaded command bsh method bshmethod meth get method getmethod arg types argtypes meth helper caches cache class cacheclass string class cache classcache class cache classcache hashtable cache count cachecount debug class cache classcache load namespace account imports search proceed parent namespaces get class getclass string util eval error utilevalerror get class impl getclassimpl implement recursion get class impl getclassimpl parent parent get class getclass implementation get class getclass load namespace account imports check cache unqualified imported load absolute method caching unqualified names imports qualified names cached bsh class manager bshclassmanager unqualified absolute names unpackaged foo cached don searching imports time get class impl getclassimpl string util eval error utilevalerror check cache class cache classcache class cache classcache unqualified simple compound unqualified name unqualifiedname is compound iscompound unqualified check imported unqualified name unqualifiedname imported get imported class impl getimportedclassimpl imported cache cache class cacheclass absolute class for name classforname cache unqualified names prevent check unqualified name unqualifiedname cache class cacheclass interpreter debug interpreter debug get class getclass imported method takes account imports name space namespace parent chain get imported class impl getimportedclassimpl string util eval error utilevalerror explicitly imported foo bar string fullname imported classes importedclasses fullname string imported classes importedclasses fullname full imported classes full imported clas class for name classforname fullname handle imported clas is compound iscompound fullname clas get name resolver getnameresolver fullname to class toclass class not found exception classnotfoundexception interpreter debug interpreter debug imported unpackaged fullname cache full bsh class manager bshclassmanager clas cache info get class manager getclassmanager cache class info cacheclassinfo fullname clas clas clas error imported packages foo bar reverse order imports precedence imported packages importedpackages imported packages importedpackages size string string imported packages importedpackages element at elementat class for name classforname bsh class manager bshclassmanager bcm get class manager getclassmanager note explicitly imported classes packages priority method error indicating ambiguity exists bcm has super import hassuperimport string bcm get class name by unq name getclassnamebyunqname class for name classforname class for name classforname string get class manager getclassmanager class for name classforname name source namesource variable method names parent namespaces string get all names getallnames vector vec vector get all names aux getallnamesaux vec string names string vec size vec copy into copyinto names names helper implementing name source namesource get all names aux getallnamesaux vector vec enumeration var names varnames variables var names varnames has more elements hasmoreelements vec add element addelement var names varnames next element nextelement enumeration method names methodnames methods method names methodnames has more elements hasmoreelements vec add element addelement method names methodnames next element nextelement parent parent get all names aux getallnamesaux vec vector name source listeners namesourcelisteners name source namesource add listener notified names space add name source listener addnamesourcelistener name source namesource listener listener name source listeners namesourcelisteners name source listeners namesourcelisteners vector name source listeners namesourcelisteners add element addelement listener perform causing entire classpath mapped do super import dosuperimport util eval error utilevalerror get class manager getclassmanager do super import dosuperimport string to string tostring name space namespace ns name nsname to string tostring ns name nsname to string tostring is class isclass is class isclass is method ismethod method class static classstatic class instance classinstance instance serialization don serialize serializable objects write object writeobject java object output stream objectoutputstream ioexception clear resolvers don names default write object defaultwriteobject invoke method namespace args interpreter reference caller call stack required method called externally java org gjt jedit bsh invoke method invokemethod string method name methodname object args interpreter interpreter call stack callstack callstack simple node simplenode caller info callerinfo invoke method invokemethod object invoke method invokemethod string method name methodname object args interpreter interpreter eval error evalerror invoke method invokemethod method name methodname args interpreter method simply delegates invoke method invokemethod org gjt jedit bsh invoke method invokemethod string method name methodname object args interpreter interpreter call stack callstack callstack simple node simplenode caller info callerinfo declared only declaredonly invoke method invokemethod object invoke method invokemethod string method name methodname object args interpreter interpreter call stack callstack callstack simple node simplenode caller info callerinfo eval error evalerror get this getthis interpreter invoke method invokemethod method name methodname args interpreter callstack caller info callerinfo clear cached classes names class loader changed classloaderchanged name space changed namespacechanged clear cached classes names name space changed namespacechanged class cache classcache names standard packages pre import class importclass org gjt jedit bsh eval error evalerror import class importclass org gjt jedit bsh interpreter import package importpackage javax swing event import package importpackage javax swing import package importpackage java awt event import package importpackage java awt import package importpackage java net import package importpackage java util import package importpackage java import package importpackage java lang add command path addcommandpath org gjt jedit bsh commands get class getclass pre load default imports loaddefaultimports note resolver reverse order precedence rules max efficiency common import class importclass org gjt jedit bsh eval error evalerror import class importclass org gjt jedit bsh interpreter import package importpackage javax swing event import package importpackage javax swing import package importpackage java awt event import package importpackage java awt import package importpackage java net import package importpackage java util import package importpackage java import package importpackage java lang add command path addcommandpath org gjt jedit bsh commands get class getclass factory objects resolve names namespace to object toobject to class toclass to lhs tolhs intended support resolver caching allowing objects cache info resolution names performance reasons proven leave caching minimize object creation method called get name getname weren simple name space namespace method time mistake get name resolver getnameresolver string ambigname names names hashtable names ambigname ambigname names ambigname get invocation line getinvocationline simple node simplenode node get node getnode node node get line number getlinenumber string get invocation text getinvocationtext simple node simplenode node get node getnode node node get text gettext invoked java code helper method working bsh scripts commands context impossible class identifier classidentifier object attempting access method class identifier classidentifier method invocation method name space namespace convenience don bsh class identifier classidentifier identifier to class identifiertoclass class identifier classidentifier get target class gettargetclass clear variables methods imports namespace namespace root reset imports load default imports loaddefaultimports clear variables methods imported classes importedclasses imported packages importedpackages imported commands importedcommands imported objects importedobjects parent load default imports loaddefaultimports class cache classcache names compiled java object methods variables namespace scripted method command variable locally namespace method fields object checked objects checked order imports precedence note impor pattern common factor imported object importedobject vector import object importobject object obj imported objects importedobjects imported objects importedobjects vector exists remove add avoid memory leak imported objects importedobjects obj imported objects importedobjects remove obj imported objects importedobjects add element addelement obj name space changed namespacechanged import static importstatic clas imported static importedstatic imported static importedstatic vector exists remove add avoid memory leak imported static importedstatic clas imported static importedstatic remove clas imported static importedstatic add element addelement clas name space changed namespacechanged set classes defined namespace subsequent sets override set package setpackage string package name packagename package name packagename package name packagename string get package getpackage package name packagename package name packagename parent parent get package getpackage j edit jedit addition set variable setvariable string object util eval error utilevalerror set variable setvariable adds url command path add command path addcommandpath string path clas imported commands importedcommands imported commands importedcommands vector path ends with endswith path imported commands importedcommands add element addelement command path entry commandpathentry path clas remove urlfrom command path remove command path removecommandpath string path clas imported commands importedcommands imported commands importedcommands size command path entry commandpathentry entry command path entry commandpathentry imported commands importedcommands element at elementat entry path equals path entry clas clas imported commands importedcommands remove element at removeelementat command input stream inputstream get command getcommand string imported commands importedcommands string ext name extname bsh imported commands importedcommands size command path entry commandpathentry entry command path entry commandpathentry imported commands importedcommands element at elementat input stream inputstream entry clas get resource as stream getresourceasstream entry path ext name extname parent parent get command getcommand command path entry commandpathentry string path clas command path entry commandpathentry string path clas path path clas clas