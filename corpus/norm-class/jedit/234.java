authored timothy gerard endres mailto time gjt org http trustice work domain work purpose software warranty kind implied warranty merchantability author software assumes responsibility consequence modification redistribution software installer java tar output stream taroutputstream filter output stream filteroutputstream debug curr size currsize curr bytes currbytes one buf onebuf record buf recordbuf assem len assemlen assem buf assembuf tar buffer tarbuffer buffer tar output stream taroutputstream output stream outputstream tar buffer tarbuffer blksize tar buffer tarbuffer rcdsize tar output stream taroutputstream output stream outputstream block size blocksize block size blocksize tar buffer tarbuffer rcdsize tar output stream taroutputstream output stream outputstream block size blocksize record size recordsize buffer tar buffer tarbuffer block size blocksize record size recordsize debug assem len assemlen assem buf assembuf record size recordsize record buf recordbuf record size recordsize one buf onebuf sets debugging flag param debug f debugf turn debugging set debug setdebug debug f debugf debug debug f debugf sets debugging flag stream tar buffer tarbuffer param debug f debugf turn debugging set buffer debug setbufferdebug debug buffer set debug setdebug debug ends tar archive closing underlying output stream outputstream result eof record nulls written finish ioexception write eofrecord writeeofrecord ends tar archive closes underlying output stream outputstream finish called calling tar buffer tarbuffer close close ioexception finish buffer close record size stream tar buffer tarbuffer tar buffer tarbuffer record size get record size getrecordsize buffer get record size getrecordsize entry output stream writes entry header record positions output stream writing contents entry method called stream ready calls write write entry contents contents written close entry closeentry called ensure buffered data completely written output stream param entry tar entry tarentry written archive put next entry putnextentry tar entry tarentry entry ioexception entry get header getheader length tar header tarheader namelen invalid header exception invalidheaderexception file entry get header getheader tar header tarheader namelen bytes entry write entry header writeentryheader record buf recordbuf buffer write record writerecord record buf recordbuf curr bytes currbytes entry is directory isdirectory curr size currsize curr size currsize entry get size getsize close entry method called file entries data reason buffer data written stream order satisfy buffer record based writes data fragments assembled written output stream entry closed entry written close entry closeentry ioexception assem len assemlen assem len assemlen assem buf assembuf length assem buf assembuf buffer write record writerecord assem buf assembuf curr bytes currbytes assem len assemlen assem len assemlen curr bytes currbytes curr size currsize ioexception entry closed curr bytes currbytes curr size currsize bytes header written writes current tar archive entry method simply calls read param written write ioexception one buf onebuf write one buf onebuf writes bytes current tar archive entry method simply calls read param w buf wbuf buffer write archive number bytes read eof write w buf wbuf ioexception write w buf wbuf w buf wbuf length writes bytes current tar archive entry method aware current entry exception attempt write bytes length current entry method painfully aware record buffering required tar buffer tarbuffer manages buffers multiple recordsize length including assembling records small buffers method simply calls read param w buf wbuf buffer write archive param w offset woffset offset buffer bytes param num to write numtowrite number bytes write write w buf wbuf w offset woffset num to write numtowrite ioexception curr bytes currbytes num to write numtowrite curr size currsize ioexception request write num to write numtowrite bytes exceeds size header curr size currsize bytes assem len assemlen assem len assemlen num to write numtowrite record buf recordbuf length a len alen record buf recordbuf length assem len assemlen system arraycopy assem buf assembuf record buf recordbuf assem len assemlen system arraycopy w buf wbuf w offset woffset record buf recordbuf assem len assemlen a len alen buffer write record writerecord record buf recordbuf curr bytes currbytes record buf recordbuf length w offset woffset a len alen num to write numtowrite a len alen assem len assemlen assem len assemlen num to write numtowrite record buf recordbuf length system arraycopy w buf wbuf w offset woffset assem buf assembuf assem len assemlen num to write numtowrite w offset woffset num to write numtowrite assem len assemlen num to write numtowrite num to write numtowrite num to write numtowrite num to write numtowrite num to write numtowrite record buf recordbuf length system arraycopy w buf wbuf w offset woffset assem buf assembuf assem len assemlen num to write numtowrite assem len assemlen num to write numtowrite buffer write record writerecord w buf wbuf w offset woffset num record buf recordbuf length curr bytes currbytes num num to write numtowrite num w offset woffset num write eof archive record tar archive eof record consists record zeros write eofrecord writeeofrecord ioexception record buf recordbuf length record buf recordbuf buffer write record writerecord record buf recordbuf